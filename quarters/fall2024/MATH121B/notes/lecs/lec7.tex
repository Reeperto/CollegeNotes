\documentclass{subfiles}

\begin{document}

\chapter{Spectral Theorem}

\begin{lemma}
    \label{lemma:schur_lem}
    Let $T$ be a linear operator on a finite dimensional inner product space $V$. If $T$ has an eigenvector, then $T^*$ does as well.
\end{lemma}

\begin{proof}
    Suppose $v$ is an eigenvector $T$ with eigenvalue $\lambda$. Then for any $x \in V$
    \[
        0 = \iprd{0, x} = \iprd{(T - \lambda I)v, x} = \iprd{v, (T - \lambda I)^* x} = \iprd{v, (T^* - \conj{\lambda} I)x}
    .\]
    Therefore $v$ is orthogonal to the range of $T^* - \lambda I$
\end{proof}

\begin{theorem}[Schur's Theorem]
    \label{thm:schurs}
    Let $T$ be a linear operator on $V$. Suppose that the characteristic polynomial of $T$ splits. Then there exists an orthonormal basis $\beta$ for $V$ such that $[T]_{\beta}$ is upper triangular.
\end{theorem}

\begin{proof}
    We proceed with induction on the dimension $n$ of $V$. If $n = 1$, then $[T]_\beta$ is a single entry and therefore is upper triangular. Assume the statement is true for an $n-1$ dimensional space. By lemma \ref{lemma:schur_lem}, $T^*$ has a unit eigenvector $z$ with some eigenvalue $\lambda$. Let $W = \spann\qty{z}$. Note that for any $y \in W^\perp$ and $x = cz \in W$
    \begin{align*}
        \iprd{Ty, x} &= \iprd{Ty,cz} \\
                     &= \iprd{y, T^* cz} \\
                     &= \iprd{y, c T^* z} \\
                     &= \iprd{y, c \lambda z} \\
                     &= \overline{c \lambda} \iprd{y, z} = 0.
    \end{align*}
    Therefore $Ty \in W^\perp$ meaning $W^\perp$ is $T$-invariant, meaning the characteristic polynomial of $T \vert_{W^\perp}$ divides the one of $T$. Since the characteristic polynomial of $T$ splits, $T \vert_{W^\perp}$ must also split. Additionally, $\dim W^\perp = n - 1$ since $\dim W = 1$. Therefore the induction hypothesis can be applied to $W^\perp$ to get an orthonormal basis $\gamma$ such that $[T \vert_{W^\perp}]_{\gamma}$ is upper triangular. Choosing $\beta = \gamma \cup \qty{z}$ gives an orthonormal basis for $V$ since $z$ is a unit vector and $z$ is from $W$ and hence orthogonal to the basis $\gamma$ of $W^\perp$. It is clear then the matrix $[T]_\beta$ is upper triangular.
\end{proof}

\end{document}
